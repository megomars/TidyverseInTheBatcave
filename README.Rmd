---
title: "Tidyverse in the Batcave"
output: html_notebook
---
# Tidyverse in the Batcave

The tidyverse is a coherent system of packages for data manipulation, exploration and visualization that share a common design philosophy. Fundamentally, the tidyverse is about the connections between the tools that make the workflow possible.

```{r}
install.packages("tidyverse") #How to install the tidyverse package
```
## Core tidyverse consists of
1. ggplot2 - plotting library
2. dplyr - data manipulation
3. tidyr - data cleaning
4. readr - data ingest
5. purrr - tools for functions and vectors
6. tibble - reimagined data.frames
7. stringr - string manipulation
8. forcats - factors

![The Tidyverse](tidyverse1.png)

## 1. Data wrangling

Data wrangling consists of Filtering, Arranging and Mutating

```{r}
install.packages("gapminder")
install.packages("dplyr")
library(gapminder)
library(dplyr)
summary(gapminder$continent)
```
### Filtering
Look for a subset based on a certain condition. The old way of doing this is to use the *subset* base R command. The new way is to use *filter* and the pipes command. Multiple conditions are separated by a comma.
```{r}
#old way
Afghan1 <- subset(gapminder, country=="Afghanistan")
#Dplyr filter way
Afghan2 <- gapminder %>% filter(country == "Afghanistan")
#Dplyr multiple variables
Afghan2007 <- gapminder %>% filter(country =="Afghanistan", year==2007)
Afghan1 == Afghan2 #True
Afghan2007
```

### Arranging
Sort your dataset with arrange. The old way of doing this is to use the *sort* base R command. The new way is to use *arrange*.
```{r}
#old way
sort(gapminder$gdpPercap, decreasing = FALSE) #ascending order

#Dplyr arrange way
gapminder %>%
  arrange(gdpPercap) #ascending

gapminder %>%
  arrange(desc(gdpPercap)) #descending


#Combine filter and arrange
BestGDP2007 <- gapminder %>%
                    filter(year == 2007) %>%
                      arrange(desc(gdpPercap))
BestGDP2007
```

### Mutating
Mutating modifies or adds to existing columns.
```{r}
#modify a variable
gapminder %>%
  mutate(pop = pop/100000) #mutate(whatsbeingreplaced = whatsbeingcalculated)

#add a column
gapminder %>%
  mutate(gdp = gdpPercap*pop)
```
---
## 2. Data visualisation

Visualising data is done with ggplot2.
```{r}
library(ggplot2)
gapminder_1952 <- gapminder %>% filter(year == 1952)

#old way of plotting
plot(gapminder_1952$gdpPercap,gapminder_1952$lifeExp)

#Using the three base layers - data, aesthetics and geometries
ggplot(gapminder_1952, aes(x = gdpPercap, y = lifeExp)) +
  geom_point()

#apply a log transformation and color
ggplot(gapminder_1952, aes(x = gdpPercap, y = lifeExp, color=continent, size=pop)) +
  geom_point()+scale_x_log10()

#adding a facet
ggplot(gapminder_1952, aes(x = gdpPercap, y = lifeExp, color=continent, size=pop)) + geom_point()+scale_x_log10()+facet_wrap(~ continent)

```

## 3. Grouping and summarizing

```{r}
#return the mean of all life expectancies as one value
gapminder %>%
  summarize(meanLifeExp = mean(lifeExp))

#return a filtered list of two summarized values
gapminder %>% filter(year == 1957) %>% summarize(medianLifeExp = median(lifeExp), maxGdpPercap = max(gdpPercap))
```

## 4. Types of visualizations

